Updates gcc optim/ABI flags (for ARM) to state of the art.

Can be removed when updating to 2010.02 Buildroot.

Index: buildroot/target/Config.in.arch
===================================================================
--- buildroot.orig/target/Config.in.arch	2008-11-03 09:15:12.000000000 +0100
+++ buildroot/target/Config.in.arch	2010-06-03 17:39:10.000000000 +0200
@@ -13,7 +13,6 @@
 config BR2_avr32
 	bool "avr32"
 	select BR2_SOFT_FLOAT
-
 config BR2_cris
 	bool "cris"
 config BR2_ia64
@@ -72,7 +71,7 @@
 config BR2_arm922t
 	bool "arm922t"
 config BR2_arm926t
-	bool "arm926t"
+	bool "arm926ej-s (arm926t)"
 config BR2_arm10t
 	bool "arm10t"
 config BR2_arm1136jf_s
@@ -81,6 +80,9 @@
 	bool "arm1176jz-s"
 config BR2_arm1176jzf_s
 	bool "arm1176jzf-s"
+comment "cortex-A8 needs gcc >= 4.4.x"
+config BR2_cortex_a8
+	bool "cortex-A8"
 config BR2_sa110
 	bool "sa110"
 config BR2_sa1100
@@ -109,18 +111,22 @@
 	default ARM_SA1100	if BR2_sa1100
 	default ARM_XSCALE	if BR2_xscale
 	default ARM_IWMMXT	if BR2_iwmmxt
+	default ARM_CORTEXA8	if BR2_cortex_a8
 
 choice
 	prompt "Target ABI"
 	depends on BR2_arm || BR2_armeb
-	default BR2_ARM_OABI
+	default BR2_ARM_EABI
 	help
 	  Application Binary Interface to use
 
-config BR2_ARM_OABI
-	bool "OABI"
+	  Note:
+	    Using OABI is discouraged.
+
 config BR2_ARM_EABI
 	bool "EABI"
+config BR2_ARM_OABI
+	bool "OABI"
 endchoice
 
 choice
@@ -575,11 +581,13 @@
 	default arm920		if BR2_arm920
 	default arm920t		if BR2_arm920t
 	default arm922t		if BR2_arm922t
-	default arm9tdmi	if BR2_arm926t
+	default arm926ej-s	if BR2_arm926t
+	default arm10tdmi	if BR2_arm10t
 	default arm1136j-s	if BR2_arm1136j_s
 	default arm1136jf-s	if BR2_arm1136jf_s
 	default arm1176jz-s	if BR2_arm1176jz_s
 	default arm1176jzf-s	if BR2_arm1176jzf_s
+	default cortex-a8	if BR2_cortex_a8
 	default strongarm110	if BR2_sa110
 	default strongarm1100	if BR2_sa1100
 	default xscale		if BR2_xscale
@@ -686,6 +694,21 @@
 	default winchip2	if BR2_x86_winchip2
 	default c3		if BR2_x86_c3
 	default geode		if BR2_x86_geode
+	default armv4t		if BR2_arm7tdmi
+	default armv3		if BR2_arm610
+	default armv3		if BR2_arm710
+	default armv4t		if BR2_arm720t
+	default armv4t		if BR2_arm920t
+	default armv4t		if BR2_arm922t
+	default armv5te		if BR2_arm926t
+	default armv5t		if BR2_arm10t
+	default armv6j		if BR2_arm1136jf_s
+	default armv6zk		if BR2_arm1176jz_s
+	default armv6zk		if BR2_arm1176jzf_s
+	default armv7-a		if BR2_cortex_a8
+	default armv4		if BR2_sa110
+	default armv4		if BR2_sa1100
+	default armv5te		if BR2_xscale
 	default iwmmxt		if BR2_iwmmxt
 	default v0		if BR2_cris_unknown
 	default v10		if BR2_cris_generic
@@ -706,11 +729,10 @@
 
 config BR2_GCC_TARGET_ABI
 	string
-	default apcs-gnu	if BR2_arm_dunno
+	default apcs-gnu	if BR2_ARM_OABI
 	default atpcs		if BR2_arm_dunno
 	default aapcs		if BR2_arm_dunno
-	default aapcs-linux	if BR2_arm_dunno
-	default iwmmxt		if BR2_iwmmxt
+	default aapcs-linux	if BR2_ARM_EABI
 	default 32		if BR2_MIPS_OABI32
 	default n32		if BR2_MIPS_ABI32
 	default eabi		if BR2_MIPS_EABI
Index: buildroot/project/Makefile.in
===================================================================
--- buildroot.orig/project/Makefile.in	2008-11-03 09:15:03.000000000 +0100
+++ buildroot/project/Makefile.in	2010-06-03 17:05:17.000000000 +0200
@@ -11,6 +11,8 @@
 # Strip off the annoying quoting
 ARCH:=$(strip $(subst ",, $(BR2_ARCH)))
 #"))
+TARGET_ARCH:=$(strip $(subst ",, $(BR2_GCC_TARGET_ARCH)))
+#"))
 WGET:=$(strip $(subst ",, $(BR2_WGET))) $(SPIDER) $(QUIET)
 #"))
 SVN_CO:=$(strip $(subst ",, $(BR2_SVN_CO))) $(QUIET)
@@ -60,7 +62,12 @@
 endif
 
 # All non-configurable packages should be built in BUILD_DIR
+
+ifeq ($(TARGET_ARCH),)
 BUILD_DIR:=$(BASE_DIR)/$(TOPDIR_PREFIX)build_$(ARCH)$(ARCH_FPU_SUFFIX)$(TOPDIR_SUFFIX)
+else
+BUILD_DIR:=$(BASE_DIR)/$(TOPDIR_PREFIX)build_$(TARGET_ARCH)$(ARCH_FPU_SUFFIX)$(TOPDIR_SUFFIX)
+endif
 
 GNU_TARGET_SUFFIX:=-$(strip $(subst ",, $(BR2_GNU_TARGET_SUFFIX)))
 #"))
@@ -70,7 +77,11 @@
 
 # All configurable packages (like Busybox,Linux etc) should be built
 # in PROJECT_BUILD_DIR
+ifeq ($(TARGET_ARCH),)
 PROJECT_BUILD_DIR:=$(BASE_DIR)/$(TOPDIR_PREFIX)project_build_$(ARCH)$(ARCH_FPU_SUFFIX)$(TOPDIR_SUFFIX)/$(PROJECT)
+else
+PROJECT_BUILD_DIR:=$(BASE_DIR)/$(TOPDIR_PREFIX)project_build_$(TARGET_ARCH)$(ARCH_FPU_SUFFIX)$(TOPDIR_SUFFIX)/$(PROJECT)
+endif
 BINARIES_DIR:=$(BASE_DIR)/binaries/$(PROJECT)
 TARGET_DIR:=$(PROJECT_BUILD_DIR)/root
 
Index: buildroot/package/Makefile.in
===================================================================
--- buildroot.orig/package/Makefile.in	2008-11-03 09:15:31.000000000 +0100
+++ buildroot/package/Makefile.in	2010-06-03 15:29:24.000000000 +0200
@@ -110,7 +110,11 @@
 endif
 
 ifeq ($(BR2_TOOLCHAIN_SOURCE),y)
+ifeq ($(CC_TARGET_ARCH_),)
 TOOL_BUILD_DIR=$(BASE_DIR)/$(TOPDIR_PREFIX)toolchain_build_$(ARCH)$(COND_ARCH_FPU_SUFFIX)$(TOPDIR_SUFFIX)
+else
+TOOL_BUILD_DIR=$(BASE_DIR)/$(TOPDIR_PREFIX)toolchain_build_$(CC_TARGET_ARCH_)$(COND_ARCH_FPU_SUFFIX)$(TOPDIR_SUFFIX)
+endif
 
 # Quotes are needed for spaces et al in path components.
 TARGET_PATH="$(TOOL_BUILD_DIR)/bin:$(STAGING_DIR)/bin:$(STAGING_DIR)/usr/bin:$(PATH)"
