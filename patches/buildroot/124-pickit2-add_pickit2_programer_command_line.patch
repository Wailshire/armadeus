Adding PICKit 2 programmer command line

Signed-off-by: Fabien Marteau <fabien.marteau@armadeus.com>

Index: buildroot/package/Config.in
===================================================================
--- buildroot.orig/package/Config.in	2010-07-13 10:10:50.000000000 +0200
+++ buildroot/package/Config.in	2010-07-13 10:10:50.000000000 +0200
@@ -268,6 +268,7 @@
 source "package/i2c-tools/Config.in"
 source "package/input-tools/Config.in"
 source "package/iostat/Config.in"
+source "package/pickit2/Config.in"
 source "package/lcd4linux/Config.in"
 source "package/libaio/Config.in"
 source "package/libraw1394/Config.in"
Index: buildroot/package/pickit2/Config.in
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ buildroot/package/pickit2/Config.in	2010-07-13 10:10:50.000000000 +0200
@@ -0,0 +1,5 @@
+config BR2_PACKAGE_PICKIT2
+        bool "pickit2"
+        select BR2_PACKAGE_LIBUSB
+        help
+            Use microchip programmer adapt PICkit 2
Index: buildroot/package/pickit2/pickit2.mk
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ buildroot/package/pickit2/pickit2.mk	2010-07-13 11:01:08.000000000 +0200
@@ -0,0 +1,49 @@
+#############################################################
+#
+# PICkit2
+#
+#############################################################
+PICKIT2_VERSION:=1.20
+PICKIT2_BINARY:=pk2cmd
+PICKIT2_SOURCE:=$(PICKIT2_BINARY)v$(PICKIT2_VERSION)LinuxMacSource.tar.gz
+PICKIT2_SITE:=http://ww1.microchip.com/downloads/en/DeviceDoc/
+PICKIT2_DIR:=$(BUILD_DIR)/pickit2-$(PICKIT2_VERSION)/
+PICKIT2_TARGET_BINARY:=usr/bin/pk2cmd
+
+$(DL_DIR)/$(PICKIT2_SOURCE):
+	$(call DOWNLOAD,$(PICKIT2_SITE),$(PICKIT2_SOURCE))
+
+$(PICKIT2_DIR)/.source: $(DL_DIR)/$(PICKIT2_SOURCE)
+	$(ZCAT) $(DL_DIR)/$(PICKIT2_SOURCE) | tar -C $(BUILD_DIR) $(TAR_OPTIONS) -
+	mv $(BUILD_DIR)/$(PICKIT2_BINARY)v$(PICKIT2_VERSION)LinuxMacSource $(PICKIT2_DIR)
+	touch $@
+
+$(PICKIT2_DIR)/.configured: $(PICKIT2_DIR)/.source
+	touch $@
+
+$(PICKIT2_DIR)/$(PICKIT2_BINARY): $(PICKIT2_DIR)/.configured
+	$(MAKE) -C $(PICKIT2_DIR) CC=$(TARGET_CXX) LIBUSB=$(STAGING_DIR)/usr/lib/ TARGET=linux
+
+$(TARGET_DIR)/$(PICKIT2_TARGET_BINARY): $(PICKIT2_DIR)/$(PICKIT2_BINARY)
+	$(INSTALL) -D $(PICKIT2_DIR)/PK2DeviceFile.dat $(TARGET_DIR)/usr/share/pk2/PK2DeviceFile.dat
+	$(INSTALL) -D $(PICKIT2_DIR)/pk2cmd $(TARGET_DIR)/usr/bin/pk2cmd
+
+pickit2: libusb $(TARGET_DIR)/$(PICKIT2_TARGET_BINARY)
+
+pickit2-source: $(DL_DIR)/$(PICKIT2_SOURCE)
+
+pickit2-clean:
+	-$(MAKE) -C $(PICKIT2_DIR) clean
+
+pickit2-dirclean:
+	rm -rf $(PICKIT2_DIR)
+
+############################################################
+#
+#  Toplevel Makefile options
+#
+############################################################
+ifeq ($(BR2_PACKAGE_PICKIT2),y)
+TARGETS+=pickit2
+endif
+
