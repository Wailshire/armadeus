#!/bin/sh
#
# start/stop i2c interface.

test -f /lib/modules/2.6.12/kernel/drivers/i2c/busses/i2c-imx.ko || exit 0
test -f /lib/modules/2.6.12/kernel/drivers/i2c/i2c-core.ko || exit 0
test -f /lib/modules/2.6.12/kernel/drivers/i2c/i2c-dev.ko || exit 0

case "$1" in
    start)
	echo "Starting i2c drivers"
	insmod /lib/modules/2.6.12/kernel/drivers/i2c/i2c-core.ko
	insmod /lib/modules/2.6.12/kernel/drivers/i2c/i2c-dev.ko
	insmod /lib/modules/2.6.12/kernel/drivers/i2c/busses/i2c-imx.ko
	;;
    stop)
	echo  "Stopping i2c drivers"
	rmmod /lib/modules/2.6.12/kernel/drivers/i2c/busses/i2c-imx.ko
	rmmod /lib/modules/2.6.12/kernel/drivers/i2c/i2c-dev.ko
	rmmod /lib/modules/2.6.12/kernel/drivers/i2c/i2c-core.ko
	;;
    restart)
	$0 stop
	$0 start
	;;
    *)
	echo "Usage: /etc/init.d/S22i2c {start|stop|restart}"
	exit 1
	;;
esac

exit 0

